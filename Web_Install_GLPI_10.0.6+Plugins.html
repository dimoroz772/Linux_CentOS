<head>
  <title>Install GLPI 10.0.6 + Plugins</title>
  <link rel="shortcut icon" href="./CentOS_Logo.png" type="image/png">
</head>
 <head>
  <meta charset="utf-8">
 </head>
<style>
.neonText1 {
  color: #87CEFA;
  text-shadow:
      0 0 1px #4169E1,
      0 0 1px #4169E1,
      0 0 1px #4169E1,
      0 0 1px #4169E1,
      0 0 1px #4169E1,
      0 0 1px #4169E1,
      0 0 1px #4169E1,
      0 0 1px #4169E1;
}
.neonText2 {
  color: #00FF00;
  text-shadow:
      0 0 1px #006400,
      0 0 1px #006400,
      0 0 1px #006400,
      0 0 1px #006400,
      0 0 1px #006400,
      0 0 1px #006400,
      0 0 1px #006400,
      0 0 1px #006400;
}
/* Additional styling */
body{
    background-color: black;
    background-repeat: no-repeat;
    background-size: cover;
    background-attachment: fixed;
    max-width: 1400px;
    margin: 0 auto;
    padding: 20px;
    color: #cfcfcf;
}
a {
    text-decoration: none;
}
p {
  text-indent: 1.5em;
  font-family: monospace;
  font-weight: 500;
  white-space: pre;
  line-height: 2;
  letter-spacing: 1px;
}
</style>
<div class="container">
<p class="neonText1">
Развертывание сервера с системой работы с заявками и инцидентами, а также для инвентаризации компьютерного оборудования на ОС Linux CentOS 7
--------------------------------------------------------------------------------------------------------------------------------------------------------------
Все описанные ниже действия выполнялись под пользователем root
--------------------------------------------------------------------------------------------------------------------------------------------------------------
Всем привет! Для реализации данного проекта мне потребовалось:
1) Прописать статические IP-адреса;
2) Обновить пакеты ОС Linux CentOS 7 до последней версии;
3) Установить дополнительные пакеты;
4) Настроить часовой пояс;
5) Настроить Firewalld и SELinux;
6) Подключить EPEL-репозиторий и обновить пакеты;
7) Установить и запустить Apache;
8) Установить и настроить PHP 8.1;
9) Настроить Apache и PHP;
10) Установить и настроить MariaDB;
11) Загрузить и установить ПО GLPI;
12) Загрузить и установить плагин FusionInventory;
13) Загрузить и установить плагин Reports;
14) Загрузить и установить плагин Barcode;
15) Загрузить и установить плагин TelegramBot;
16) Исправить ошибку "13 tables are using the deprecated MyISAM storage engine. Run the "php bin/console glpi:migration:myisam_to_innodb" command to migrate them.".
--------------------------------------------------------------------------------------------------------------------------------------------------------------
Предисловие
------------
Nano — это консольный текстовый редактор для UNIX и Unix-подобных операционных систем, основанный на библиотеке curses и распространяемый под лицензией GNU GPL.
------------
SELinux — реализация системы принудительного контроля доступа, которая может работать параллельно с классической избирательной системой контроля доступа.
------------
NMTUI — это инструмент командной строки, который используется для настройки сети в системах Gnu / Linux. При запуске он вызывает графический текстовый 
интерфейс, который помогает пользователям легко и эффективно настраивать сетевые интерфейсы.
------------
GLPI — аббревиатура для Gestionnaire libre de parc informatique, является системой работы с заявками и инцидентами, а также для инвентаризации компьютерного оборудования.
------------
ntpdate — это компьютерная программа, используемая для быстрой синхронизации и установки даты и времени компьютеров путем запроса к серверу Network Time Protocol.
------------
Vim — это свободный текстовый редактор, созданный на основе более старого vi.
------------
EPEL (Extra Packages for Enterprise Linux) ― это открытое бесплатное хранилище пакетов от Fedora.
------------
REMI ― это репозиторий, который содержит свежие сборки PHP, MySQL/MariaDB, Apache.
------------
MariaDB — это ответвление от системы управления базами данных MySQL, разрабатываемое сообществом под лицензией GNU GPL.
------------
PHP - это инструмент для создания персональных страниц
------------
Apache HTTP Server, также известный как httpd, является самым популярным веб-сервером в мире, и он является стандартным веб-сервером для CentOS 7.
------------
DataBase — это совокупность данных, хранимых в соответствии со схемой данных, манипулирование которыми выполняют в соответствии с правилами средств моделирования данных.
------------
InnoDB — это одна из выбираемых подсистем низкого уровня в СУБД MySQL, входит во все стандартные сборки для различных операционных систем.
--------------------------------------------------------------------------------------------------------------------------------------------------------------
Перед тем как разворачивать ПО GLPI, прошу вас тщательно изучить то, какие вы будете устанавливать плагины. У некоторых плагинов есть определенная поддерживаемая версия ПО GLPI!!!
--------------------------------------------------------------------------------------------------------------------------------------------------------------
Используемые версии ПО для реализации данного проекта:
------------
GLPI -version- 10.0.6
------------
PHP -version- 8.1
------------
MariaDB -version- 11.3
------------
fusioninventory -version- 10.0.6+1.1
------------
glpi-reports -version- 1.16.0
------------
glpi-barcode -version- 2.7.1
------------
glpi-telegrambot-2.0.0
--------------------------------------------------------------------------------------------------------------------------------------------------------------
1) Для избежания потери связи с АРМ/VM, нужно позаботиться о статической IP-адресации. Её можно настроить как на самой АРМ/VM, так и на самом сетевом 
устройстве. Статическую адресацию можно прописать с помощью инструмента командной строки nmtui.
------------
<a class="neonText2">yum install -y NetworkManager-tui</a> |#|#| Установка пакета "nmtui" для настройки сети на АРМ/VM
------------
Гайд по тому, как пользоваться инструментом nmtui, вы можете посмотреть в интернете.
--------------------------------------------------------------------------------------------------------------------------------------------------------------
2) Обновление пакетов системы.
------------
<a class="neonText2">yum update -y && yum upgrade -y</a> |#|#| Поиск и обновление пакетов системы
------------
<a class="neonText2">reboot</a> |#|#| Команда для перезагрузки АРМ/VM
--------------------------------------------------------------------------------------------------------------------------------------------------------------
3) Установка дополнительных пакетов.
------------
<a class="neonText2">yum install -y ntpdate yum-utils nano wget</a> |#|#| Команда для установки пакетов "ntpdate", "yum-utils", "nano" и "wget"
--------------------------------------------------------------------------------------------------------------------------------------------------------------
4) Настройка часового пояса.
------------
<a class="neonText2">cp /usr/share/zoneinfo/Asia/Yekaterinburg /etc/localtime</a> |#|#| Команда для задания часового пояса "Asia/Yekaterinburg"
------------
<a class="neonText2">crontab -e</a> |#|#| Команда для открытия конфигурационного файла планировщика задач ПО "crontab" в текстовом редакторе "vim"
------------
Гайд по тому, как пользоваться инструментом vim, вы можете посмотреть в интернете.
------------
Пропишите в конфигурационном файле следующую строку, которая отвечает за актуализацию времени:
<a class="neonText2">
0 0 * * * /sbin/ntpdate ru.pool.ntp.org</a>
--------------------------------------------------------------------------------------------------------------------------------------------------------------
5) Настройка Firewalld и SELinux.
------------
<a class="neonText2">firewall-cmd --permanent --add-port=80/tcp</a> |#|#| Команда для открытия 80 tcp-порта
------------
<a class="neonText2">firewall-cmd --permanent --add-port=443/tcp</a> |#|#| Команда для открытия 443 tcp-порта
------------
<a class="neonText2">firewall-cmd --reload</a> |#|#| Команда для перезапуска файрвола и применения всех изменений
------------
<a class="neonText2">sed -i "s/SELINUX=enforcing/SELINUX=disabled/" /etc/selinux/config</a> |#|#| Команда для отключения SELinux на постоянную основу
------------
<a class="neonText2">setenforce 0</a> |#|#| Команда для отключения SELinux в текущий момент
--------------------------------------------------------------------------------------------------------------------------------------------------------------
6) Подключение EPEL-репозитория и обновление пакетов.
------------
<a class="neonText2">yum install -y epel-release</a> |#|#| Команда для подключения EPEL-репозитория
------------
<a class="neonText2">yum update -y</a> |#|#| Команда для обновления установленных пакетов в системе 
--------------------------------------------------------------------------------------------------------------------------------------------------------------
7) Установка и запуск Apache.
------------
<a class="neonText2">yum install -y httpd</a> |#|#| Команда для установки пакета "httpd"
------------
<a class="neonText2">systemctl enable httpd</a> |#|#| Команда для добавления службы "httpd" в автозагрузку
------------
<a class="neonText2">systemctl start httpd</a> |#|#| Команда для запуска службы "httpd"
--------------------------------------------------------------------------------------------------------------------------------------------------------------
8) Установка и настройка PHP 8.1.
------------
<a class="neonText2">yum install -y https://rpms.remirepo.net/enterprise/remi-release-7.rpm</a> |#|#| Команда для подключения REMI-репозитория
------------
<a class="neonText2">yum-config-manager --disable 'remi-php*'</a> |#|#| Команда для отключения установки выбренной версии PHP по умолчанию из REMI-репозитория
------------
<a class="neonText2">yum-config-manager --enable remi-php81</a> |#|#| Команда для включения установки версии PHP 8.1 по умолчанию из REMI-репозитория
------------
<a class="neonText2">yum install -y php php-{cli,fpm,mysqlnd,zip,devel,gd,mbstring,curl,xml,pear,bcmath,json,opcache,redis,memcache}</a> |#|#| Команда для установки пакетов "php"
------------
<a class="neonText2">yum install -y php-mbstring php-gd php-simplexml php-intl php-mysql php-mysqli</a> |#|#| Команда для установки дополнительных пакетов "php"
------------
<a class="neonText2">yum install -y php-ldap php-imap php-pecl-zendopcache php-pecl-apcu php-xmlrpc php-pear-CAS php-zip php-sodium</a> |#|#| Команда для установки дополнительных пакетов "php"
------------
<a class="neonText2">nano /etc/php.ini</a> |#|#| Данной командой отредактируем конфигурационный файл "php.ini"
------------
Найдите и приведите строки в конфигурационном файле к следующему виду(по надобности раскомментируйте):
<a class="neonText2">
upload_max_filesize = 256M

post_max_size = 256M

date.timezone = "Asia/Yekaterinburg"</a>
--------------------------------------------------------------------------------------------------------------------------------------------------------------
9) Настройка Apache и PHP.
------------
<a class="neonText2">nano /etc/httpd/conf/httpd.conf</a> |#|#| Данной командой отредактируем конфигурационный файл "httpd.conf"
------------
Найдите и приведите строки в конфигурационном файле к следующему виду(добавьте index.php):
<a class="neonText2">
&lt;IfModule dir_module&gt;
    DirectoryIndex index.php index.html
&lt;/IfModule&gt;</a>
------------
<a class="neonText2">nano /etc/httpd/conf.d/glpi.conf</a> |#|#| Данной командой создадим/отредактируем конфигурационный файл "glpi.conf"
------------
Приведите конфигурационный файл к следующему виду:
<a class="neonText2">
&lt;VirtualHost *:80&gt;
    Define root_domain glpi.test.local
    Define root_path /var/www/glpi

    ServerName ${root_domain}
    DocumentRoot ${root_path}
&lt;/VirtualHost&gt;</a>
------------
<a class="neonText2">systemctl restart httpd</a> |#|#| Команда для перезапуска службы "httpd"
------------
<a class="neonText2">mkdir -p /var/www/glpi</a> |#|#| Команда для создания каталога "/var/www/glpi"
------------
<a class="neonText2">nano /var/www/glpi/index.php</a> |#|#| Данной командой создадим/отредактируем конфигурационный файл "index.php"
------------
Приведите конфигурационный файл к следующему виду:
<a class="neonText2">
&lt;?php phpinfo(); ?&gt;</a>
--------------------------------------------------------------------------------------------------------------------------------------------------------------
10) Установка и настройка MariaDB.
------------
Актуальную версию MariaDB можно найти на сайте: https://downloads.mariadb.org/mariadb/repositories
------------
<a class="neonText2">nano /etc/yum.repos.d/mariadb-11.3.repo</a> |#|#| Команда для добавления репозитория с ПО MariaDB версии 11.3
------------
<a class="neonText2">yum update -y</a> |#|#| Команда для обновления установленных пакетов в системе
------------
<a class="neonText2">yum install -y mariadb-server</a> |#|#| Команда для установки пакета "mariadb-server"
------------
<a class="neonText2">systemctl enable mariadb</a> |#|#| Команда для добавления службы "mariadb" в автозагрузку
------------
<a class="neonText2">systemctl start mariadb</a> |#|#| Команда для запуска службы "mariadb"
------------
<a class="neonText2">mysqladmin -u root password</a> |#|#| Выполним данную команду для задания пароля суперпользователю СУБД
------------
<a class="neonText2">systemctl restart httpd</a> |#|#| Команда для перезапуска службы "httpd"
------------
<a class="neonText2">mysql -uroot -p</a> |#|#| Команда для подключения к MariaDB с помощью пользователя root
------------
<a class="neonText2">CREATE DATABASE glpi DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;</a> |#|#| Команда для создания базы данных "glpi"
------------
<a class="neonText2">GRANT ALL PRIVILEGES ON glpi.* TO glpi@localhost IDENTIFIED BY 'GlpIAdmiN';</a> |#|#| Команда для создания пользователя "glpi" с паролем "GlpIAdmiN"
------------
<a class="neonText2">\q</a> |#|#| Команда для выхода из "MariaDB"
--------------------------------------------------------------------------------------------------------------------------------------------------------------
11) Загрузка и установка ПО GLPI.
------------
<a class="neonText2">wget https://github.com/glpi-project/glpi/releases/download/10.0.6/glpi-10.0.6.tgz</a> |#|#| Команда для скачивания сжатого архива с ПО "glpi" с версией "10.0.6"
------------
<a class="neonText2">systemctl restart httpd</a> |#|#| Команда для перезапуска службы "httpd"
------------
<a class="neonText2">tar -xvzf glpi-*.tgz -C /var/www/glpi --strip-components 1</a> |#|#| Команда для распаковки архива в созданный ранее каталог "/var/www/glpi"
------------
<a class="neonText2">chown -R apache:apache /var/www/glpi</a> |#|#| Команда для назначения каталогу "/var/www/glpi" владельца и группы с наименованием "Apache"
------------
Для дальнейшей установки ПО "GLPI", запускаем браузер и вводим адрес сервера: http://ip-address/
------------
Попав в Web-интерфейс, приступаем к графической установке ПО GLPI:
------------

1 - Выбираем язык ПО > OK
2 - Принимаем лицензионное соглашение > Продолжить
3 - Кликаем по кнопке "Установить"
4 - В данном шаге нужно ввести данные для подключения к БД созданной в MariaDB:
SQL сервер (MariaDB или MySQL): localhost
SQL пользователь: glpi
SQL пароль: GlpIAdmiN
5 - Выбираем БД "glpi" > Продолжить
6 - После успешной инициализации БД запускаем GLPI
------------
Для первоначального входа в систему GLPI используются следующие учетные данные:

Login: glpi
Password: glpi
------------
После входа в систему обязательно смените пароли у всех пользователей, по необходимости можете создать новых и удалить тех, что созданы по умолчанию.
------------
Также после входа в систему, на главном экране будут показаны подсказки по тем действиям, которые нужно выполнить в первую очередь перед началом использования ПО.
------------
<a class="neonText2">rm -rf /var/www/glpi/install/install.php</a> |#|#| Команда для удаления с сервера файла установки GLPI
------------
<a class="neonText2">crontab -e</a> |#|#| Команда для открытия конфигурационного файла планировщика задач ПО "crontab" в текстовом редакторе "vim"
------------
Добавьте в конфигурационном файле вторую строку, которая отвечает за запуск некоторых функций в ПО GLPI:
<a class="neonText2">
* * * * * /bin/php /var/www/glpi/front/cron.php &>/dev/null</a>
--------------------------------------------------------------------------------------------------------------------------------------------------------------
12) Загрузка и установка плагина FusionInventory.
------------
<a class="neonText2">yum install -y bzip2</a> |#|#| Команда для установки пакета "bzip2"
------------
<a class="neonText2">wget https://github.com/fusioninventory/fusioninventory-for-glpi/releases/download/glpi10.0.6%2B1.1/fusioninventory-10.0.6+1.1.tar.bz2</a> |#|#| Команда для скачивания архив-файла плагина "fusioninventory"
------------
<a class="neonText2">tar -xvjf fusioninventory-*.tar.bz2 -C /var/www/glpi/plugins/</a> |#|#| Команда для распаковки архива в каталог "/var/www/glpi/plugins/"
------------
После распаковки плагина переходим в каталог, переходим в Web-интерфейс с ПО "GLPI" > Настройки > Плагины > Установить > Включить.
--------------------------------------------------------------------------------------------------------------------------------------------------------------
13) Загрузка и установка плагина Reports.
------------
<a class="neonText2">wget https://github.com/yllen/reports/releases/download/v1.16.0/glpi-reports-1.16.0.tar.gz</a> |#|#| Команда для скачивания архив-файла плагина "reports"
------------
<a class="neonText2">tar -xvzf glpi-reports-*.tar.gz -C /var/www/glpi/plugins/</a> |#|#| Команда для распаковки архива в каталог "/var/www/glpi/plugins/"
------------
После распаковки плагина переходим в каталог, переходим в Web-интерфейс с ПО "GLPI" > Настройки > Плагины > Установить > Включить.
--------------------------------------------------------------------------------------------------------------------------------------------------------------
14) Загрузка и установка плагина Barcode.
------------
<a class="neonText2">wget https://github.com/pluginsGLPI/barcode/releases/download/2.7.1/glpi-barcode-2.7.1.tar.bz2</a> |#|#| Команда для скачивания архив-файла плагина "reports"
------------
<a class="neonText2">tar -xvjf glpi-barcode-*.tar.bz2 -C /var/www/glpi/plugins/</a> |#|#| Команда для распаковки архива в каталог "/var/www/glpi/plugins/"
------------
После распаковки плагина переходим в каталог, переходим в Web-интерфейс с ПО "GLPI" > Настройки > Плагины > Установить > Включить.
--------------------------------------------------------------------------------------------------------------------------------------------------------------
15) Загрузка и установка плагина TelegramBot.
------------
<a class="neonText2">wget https://github.com/pluginsGLPI/telegrambot/releases/download/2.0.0/glpi-telegrambot-2.0.0.tar.bz2</a> |#|#| Команда для скачивания архив-файла плагина "telegrambot"
------------
<a class="neonText2">tar -xvjf glpi-telegrambot-*.tar.bz2 -C /var/www/glpi/plugins/</a> |#|#| Команда для распаковки архива в каталог "/var/www/glpi/plugins/"
------------
После распаковки плагина переходим в каталог, переходим в Web-интерфейс с ПО "GLPI" > Настройки > Плагины > Установить > Включить.
--------------------------------------------------------------------------------------------------------------------------------------------------------------
16) Исправление ошибки "13 tables are using the deprecated MyISAM storage engine. Run the "php bin/console glpi:migration:myisam_to_innodb" command to migrate them.".
------------
<a class="neonText2">cd /var/www/glpi/</a> |#|#| Команда для перехода в каталог "/var/www/glpi/"
------------
<a class="neonText2">php bin/console migration:myisam_to_innodb</a> |#|#| Выполнив данную команду, вы мигрируете существующие "db" в движок "InnoDB".
--------------------------------------------------------------------------------------------------------------------------------------------------------------
На этом инструкция закончена! Спасибо за внимание!
</p>
</div>
